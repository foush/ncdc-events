<link rel="import" href="../../../bower_components/polymer/polymer.html">
<script src="../../../bower_components/moment/moment.js"></script>
<dom-module id="ncdc-schedule-slot">
    <template>
        <div>
            <span id="title">[[session.title]]</span>
        </div>
    </template>
</dom-module>
<script>
    (function () {
        'use strict';

        Polymer({
            is: "ncdc-schedule-slot",
            extends: "td",
            properties: {
                room: {
                    type: Array
                },
                sessions: {
                    type: Object,
                    observer: '_onSessions'
                },
                session: {
                    type: Object,
                    computed: '_getSession(room, sessions)'
                }
            },
            listeners: {
                'click': '_onClick'
            },
            _getSession: function(room, sessions) {
                for (var i = 0; i < sessions.length; i++) {
                    if (sessions[i].rooms.indexOf(room) >= 0) {
                        return sessions[i];
                    }
                }
                return null;
            },
            _onSessions: function(newVal, oldVal) {
                if (newVal.length < 2) {
                    this.setAttribute('colspan', 5);
                    this.toggleClass('banner', true);
                }
            },
            _onClick: function(ev) {
                this.fire('session-select', {
                    session: this.session,
                    title: this.$.title,
                    element: this,
                    coords: {x: event.x, y: event.y}
                });
            }

        });
    })();
</script>